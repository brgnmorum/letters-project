<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>NaTuRE of Letters</title>
<style>
  body { margin:0; overflow:hidden; }
  canvas { display:block; }
   #resetBtn {
      position: absolute;
      top: 20px;
      left: 20px;
      padding: 10px 15px;
      font-size: 16px;
      z-index: 10;
      cursor: pointer;
      border: none;
      border-radius: 5px;
  }
</style>
</head>
<body>
<canvas id="canvas"></canvas>
<button id="resetBtn">Reset</button>
<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;


// üåø ÌÖçÏä§Ìä∏
const normalFontSize = 32;
const boldFontSize = 48;
const normalFont = `${normalFontSize}px 'Malgun Gothic', Arial, sans-serif`;
const boldFont = `bold ${boldFontSize}px 'Malgun Gothic', Arial, sans-serif`;
const messageBefore = "Let Your Sentence Become";
const implementAlphabets = "Implemented: A, S, P, O, C, Z, E, Y";
const messageBold = "NaTuRE";
const textY = canvas.height / 5;


// üåÑ A ÏÇ∞
const mountainColorsBase = ["#27ae60", "#16a085", "#1abc9c"];
let mountains = [];

// üåä S Î¨ºÍ≤∞
const waveColorsBase = ["#6098be", "#668bd6", "#77c5ca"];
let waves = [];

// üéà P ÌíçÏÑ†
const balloonColors = ["#e74c3c","#f39c12","#9b59b6","#3498db","#f9c11a"];
let balloons = [];

// ‚òÄÔ∏è O ÌÇ§ Ìï¥, üåô C ÌÇ§ Îã¨
let sun = { x: canvas.width * 0.8, y: canvas.height * 0.2, radius: 60, color:"#c0392b" };
let moon = null;
let bgColor = "#e9d8b9";
let isAnimatingSun = false;
let isAnimatingMoon = false;

// Z Î≤àÍ∞ú
let lightnings = [];

// E.
let eLetters = []; // ÌôîÎ©¥Ïóê ÎÇòÌÉÄÎÇú EÎì§ÏùÑ Ï†ÄÏû•

// ‚ù§Ô∏è Y ÌïòÌä∏
let hearts = []; // ÌôîÎ©¥Ïóê ÎÇòÌÉÄÎÇú ÌïòÌä∏ Î∞∞Ïó¥

// U ÏõÉÎäî ÏñºÍµ¥
let smiles = [];

//----------------------------------------------------

const resetBtn = document.getElementById("resetBtn");

function updateResetBtn(){
    resetBtn.addEventListener("click", (e) => {
       // ÎßàÏö∞Ïä§ ÌÅ¥Î¶≠Îßå Ï≤òÎ¶¨
        if (e.detail === 0) return; // detail 0Ïù¥Î©¥ ÌÇ§Î≥¥Îìú ÏûÖÎ†•
        e.preventDefault();
        doReset(); 
    });
    if(moon){ // Î∞§
        resetBtn.style.backgroundColor = "#ecf0f1"; 
        resetBtn.style.color = "#201b13"; 
    } else {    // ÎÇÆ
        resetBtn.style.backgroundColor = "#201b13"; 
        resetBtn.style.color = "#ecf0f1"; 
    }
}
resetBtn.addEventListener("click", () => {
    // ÏÇ¨Ïö©Ïûê ÏûÖÎ†• Ï¥àÍ∏∞Ìôî
    userLines = [""];
    currentLine = 0;

    // Î∞∞Í≤Ω Ï¥àÍ∏∞Ìôî (Í∏∞Î≥∏ ÎÇÆ)
    bgColor = "#e9d8b9";

    // ÏÇ∞, Î¨ºÍ≤∞, ÌíçÏÑ† Ï¥àÍ∏∞Ìôî
    mountains = [];
    waves = [];
    balloons = [];
    lightnings = [];
    eLetters = [];
    hearts = [];
    smiles = [];

    // Ìï¥/Îã¨ Ï¥àÍ∏∞Ìôî
    sun = { x: canvas.width * 0.8, y: canvas.height * 0.2, radius:60, color:"#c0392b" };
    moon = null;
    isAnimatingSun = false;
    isAnimatingMoon = false;

    // Î≤ÑÌäº ÏÉâÏÉÅ ÏóÖÎç∞Ïù¥Ìä∏
    updateResetBtn();
});
updateResetBtn();

// ÏÇ¨Ïö©Ïûê ÏûÖÎ†•
let userLines = [""];
let currentLine = 0;
const inputStartY = textY + boldFontSize + 40; // NATURE ÏïÑÎûò Ï°∞Í∏à ÏïÑÎûò
const lineHeight = normalFontSize + 10;

// ÏÉâ Î∞ùÍ∏∞ Ï°∞Ï†ï Ìï®Ïàò
function adjustColorBrightness(color, amount){
    let c = color.substring(1);
    let num = parseInt(c,16);
    let r = (num >> 16) + amount;
    let g = ((num >> 8) & 0x00FF) + amount;
    let b = (num & 0x0000FF) + amount;
    r = Math.min(255, Math.max(0,r));
    g = Math.min(255, Math.max(0,g));
    b = Math.min(255, Math.max(0,b));
    return `rgb(${r},${g},${b})`;
}

//-------------------------------------------------

// üåÑ ÏÇ∞ ÏÉùÏÑ±
function createMountain(){
    const maxBaseWidth = canvas.width / 5;
    const baseWidth = 50 + Math.random() * maxBaseWidth;
    const maxHeight = canvas.height - (textY + boldFontSize + 10);
    let height = 50 + Math.random() * maxHeight;
    const x = Math.random() * canvas.width;
    const color = mountainColorsBase[Math.floor(Math.random() * mountainColorsBase.length)];
    return { x, baseWidth, height, currentHeight: 0, color, currentAdjust: 0 };
}

// üåä Î¨ºÍ≤∞ ÏÉùÏÑ±
function createWave(){
    const amplitude = 20 + Math.random() * 30; 
    const wavelength = 80 + Math.random() * 100;
    const speed = 0.5 + Math.random() * 2; 
    const y = canvas.height * 0.95 + Math.random() * (canvas.height * 0.05);
    const color = waveColorsBase[Math.floor(Math.random() * waveColorsBase.length)];
    const lineWidth = 2 + Math.random() * 58;
    return { amplitude, wavelength, speed, y, color, lineWidth, offsetX: 0, currentAdjust: 0 };
}

// üéà ÌíçÏÑ† ÏÉùÏÑ±
function createBalloon(){
    const radius = 15 + Math.random() * 20;
    const x = Math.random() * canvas.width * 0.8 + canvas.width*0.1;
    const y = canvas.height - radius - Math.random() * 50;
    const color = balloonColors[Math.floor(Math.random()*balloonColors.length)];
    const speedX = 1 + Math.random()*2;
    const speedY = 1 + Math.random()*2;
    return {x, y, radius, color, speedX, speedY};
}

// üåû Ìï¥ ÏÉùÏÑ±
function createSun(){
    isAnimatingSun = true;
    moon = null;
    return { x: -60, y: canvas.height * 0.8, radius: 60, targetX: canvas.width * 0.8, targetY: canvas.height * 0.2, color:"#c0392b" };
}

// üåô Îã¨ ÏÉùÏÑ±
function createMoon(){
    isAnimatingMoon = true;
    sun = null;
    return { x: -60, y: canvas.height * 0.8, radius: 60, targetX: canvas.width * 0.8, targetY: canvas.height * 0.2, color:"#f0d25c" };
}

//Z Î≤àÍ∞ú ÏÉùÏÑ±
function createLightning() {
    const startX = Math.random() * canvas.width;
    const totalHeight = canvas.height; // Î∞îÎã•ÍπåÏßÄ ÎÇ¥Î†§Í∞ÄÎèÑÎ°ù
    const segments = 10 + Math.floor(Math.random() * 10); 
    const segmentLength = totalHeight / segments; // ÏÑ∏Í∑∏Î®ºÌä∏ Í∏∏Ïù¥ Í≥†Ï†ï ‚Üí Ï†ÑÏ≤¥ ÎÜíÏù¥ = ÌôîÎ©¥ ÎÜíÏù¥
    const color = "#ffffff"; 
    return { startX, segments, segmentLength, color, y: 0 };
}

//E ÏïåÌååÎ≤≥ ÏÉùÏÑ±
function createE() {
    const colors = ["#8B4513", "#A0522D", "#D2691E"]; // Í∞àÏÉâ Í≥ÑÏó¥
    const color = colors[Math.floor(Math.random() * colors.length)];

    // ÏÇ∞ Îí§Ïóê ÏúÑÏπòÌïòÎèÑÎ°ù yÎäî ÏÇ∞ ÎÜíÏù¥ Î≤îÏúÑ ÏïàÏóêÏÑú ÎûúÎç§, xÎäî ÎûúÎç§
    const x = Math.random() * canvas.width;
    const y = canvas.height / 2 + Math.random() * canvas.height / 4;

    const size = 40 + Math.random() * 60; // ÏÇ∞ ÌÅ¨Í∏∞Ïóê ÎßûÍ≤å

    eLetters.push({x, y, size, color});
}

// ‚ù§Ô∏è ÌïòÌä∏ ÌíçÏÑ† ÏÉùÏÑ±
function createHeart() {
    const colors = ["#e74c3c", "#ff6b6b", "#ff4757"];
    const color = colors[Math.floor(Math.random() * colors.length)];
    
    const size = 40 + Math.random() * 60; // ÌïòÌä∏ ÌÅ¨Í∏∞
    const x = Math.random() * canvas.width * 0.8 + canvas.width*0.1;
    const y = canvas.height - size - Math.random() * 50 + 80;

    const speedX = 1 + Math.random() * 2;
    const speedY = 1 + Math.random() * 2;

    hearts.push({ x, y, size, color, speedX, speedY });
}

// ÏõÉÎäî ÏñºÍµ¥ ÏÉùÏÑ±
function createSmile() {
    const x = Math.random() * canvas.width * 0.8 + canvas.width*0.1;
    const y = canvas.height * 0.3 + Math.random() * canvas.height * 0.2;
    const color = ["#f1c40f", "#f39c12"][Math.floor(Math.random()*2)];
    const size = 24 + Math.random() * 16;
    smiles.push({x, y, color, size, alpha: 1, lifetime: 100});
}


//-------------------------------------------------

// ÌÇ§Î≥¥Îìú Ïù¥Î≤§Ìä∏
window.addEventListener("keydown", e => {
    const key = e.key.toUpperCase();
    if(key === "A") mountains.push(createMountain());
    if(key === "S") waves.push(createWave());
    if(key === "P") balloons.push(createBalloon());
    if(key === "Z") lightnings.push(createLightning());
    if(e.key === "E" || e.key === "e") {
        createE();
    }
    if(key === "Y") createHeart();
    if(key === "O") {
        sun = createSun();
        bgColor = "#e9d8b9";
    }
    if(key === "C") {
        moon = createMoon();
        bgColor = "#2c3e50";
    }
    if(key === "U") createSmile();
});

// ÌÖçÏä§Ìä∏
function drawMessage(){
    ctx.textAlign = "center";
    ctx.textBaseline = "middle";
    const colorText = moon ? "#ecf0f1" : "#201b13";
    ctx.fillStyle = colorText;

    ctx.font = normalFont;
    const beforeWidth = ctx.measureText(messageBefore).width;

    ctx.font = boldFont;
    const boldWidth = ctx.measureText(messageBold).width;

    const gap = 40;
    const totalWidth = beforeWidth + gap + boldWidth;
    const xStart = canvas.width / 2 - totalWidth / 2;

    ctx.font = normalFont;
    ctx.fillText(messageBefore, xStart + beforeWidth/2, textY);
    ctx.font = "16px Arial"; 
    ctx.fillText(implementAlphabets, xStart + beforeWidth/2, textY+30);

    ctx.font = boldFont;
    ctx.fillText(messageBold, xStart + beforeWidth + gap + boldWidth/2, textY);
}

// üéà ÌíçÏÑ† Í∑∏Î¶¨Í∏∞
function drawBalloons(){
    balloons.forEach(b => {
        // ÎèôÍ∑∏ÎùºÎØ∏
        ctx.fillStyle = b.color;
        ctx.beginPath();
        ctx.arc(b.x, b.y, b.radius, 0, Math.PI*2);
        ctx.fill();
        
        // Í≤ÄÏùÄ Ï§Ñ (Ïã§ÏÑ†)
        ctx.strokeStyle = "#000";
        ctx.lineWidth = 1;  // <- Ïó¨Í∏∞Î•º 1Î°ú Í≥†Ï†ï
        ctx.beginPath();
        ctx.moveTo(b.x, b.y + b.radius);
        ctx.lineTo(b.x, b.y + b.radius + b.radius*1.5);
        ctx.stroke();

        // ÏúÑÏπò Ïù¥Îèô
        b.x -= b.speedX;
        b.y -= b.speedY;
    });
}

function drawLightnings() {
    lightnings.forEach((lightning, index) => {
        ctx.strokeStyle = lightning.color;
        ctx.lineWidth = 2;
        ctx.beginPath();
        let x = lightning.startX;
        let y = 0;
        ctx.moveTo(x, y);

        for (let i = 0; i < lightning.segments; i++) {
            x += (Math.random() - 0.5) * 20; // ÏßÄÍ∑∏Ïû¨Í∑∏
            y += lightning.segmentLength;
            ctx.lineTo(x, y);
        }

        ctx.stroke();

        // Î≤àÍ∞ú Ïï†ÎãàÎ©îÏù¥ÏÖò: y Ï¶ùÍ∞Ä ‚Üí ÏùºÏ†ï ÎÜíÏù¥ ÏßÄÎÇòÎ©¥ Ï†úÍ±∞
        lightning.y += 20; // ÏÜçÎèÑ Ï°∞Ï†à
        if (lightning.y > canvas.height) {
            lightnings.splice(index, 1);
        }
    });
}

function drawEs() {
    for (const e of eLetters) {
        ctx.save();
        ctx.fillStyle = e.color;
        ctx.font = `${e.size}px Arial`;
        ctx.textAlign = "center";
        ctx.textBaseline = "bottom"; // ÏÇ∞ Îí§Ïóê ÏûêÏó∞Ïä§ÎüΩÍ≤å
        ctx.fillText("E", e.x, e.y);
        ctx.restore();
    }
}

// ‚ù§Ô∏è ÌíçÏÑ† Í∑∏Î¶¨Í∏∞
function drawHearts() {
    hearts.forEach((h, index) => {
        // Í≤ÄÏùÄ Ï§Ñ Í∑∏Î¶¨Í∏∞ (ÌíçÏÑ† Ï§ÑÏ≤òÎüº)
        ctx.strokeStyle = "#000";
        ctx.lineWidth = 1;
        ctx.beginPath();
        ctx.moveTo(h.x, h.y - h.size * 0.5);
        ctx.lineTo(h.x, h.y + h.size * 0.5);
        ctx.stroke();

        // ÌïòÌä∏ Í∑∏Î¶¨Í∏∞
        ctx.fillStyle = h.color;
        ctx.font = `${h.size}px Arial`;
        ctx.textAlign = "center";
        ctx.textBaseline = "bottom";
        ctx.fillText("‚ô•", h.x, h.y);

        // ÏúÑÏπò Ïù¥Îèô
        h.x -= h.speedX;
        h.y -= h.speedY;

        // ÌôîÎ©¥ Î∞ñÏúºÎ°ú ÎÇòÍ∞ÄÎ©¥ Î∞∞Ïó¥ÏóêÏÑú Ï†úÍ±∞
        if(h.y + h.size < 0 || h.x + h.size < 0){
            hearts.splice(index, 1);
        }
    });
}

// ÏõÉÎäî ÏñºÍµ¥ Í∑∏Î¶¨
function drawSmiles() {
    for(let i = smiles.length - 1; i >= 0; i--){
        const s = smiles[i];
        ctx.font = `${s.size}px Arial`;
        ctx.fillStyle = s.color;
        ctx.globalAlpha = s.alpha;
        ctx.textAlign = "center";
        ctx.fillText(":)", s.x, s.y);

        // ÏúÑÎ°ú Îñ†Ïò§Î•¥Í∏∞ + Ï†êÏ†ê Ìà¨Î™Ö
        s.y -= 1;
        s.alpha -= 0.01;
        s.lifetime--;

        if(s.lifetime <= 0 || s.alpha <= 0){
            smiles.splice(i,1);
        }
    }
    ctx.globalAlpha = 1; // Í∏∞Î≥∏Í∞í Î≥µÏõê
}



window.addEventListener("keydown", e => {
    const key = e.key;

    // ÏùºÎ∞ò Î¨∏Ïûê
    if(key.length === 1 && key !== " ") {
        const testLine = userLines[currentLine] + key;
        ctx.font = normalFont;
        const textWidth = ctx.measureText(testLine).width;
        const maxWidth = canvas.width * 0.9; // Ïò§Î•∏Ï™Ω Ïó¨Î∞± Ï°∞Ï†ï
        if(textWidth < maxWidth) userLines[currentLine] += key;
    }

    // Ïä§ÌéòÏù¥Ïä§
    else if(key === " ") {
        const testLine = userLines[currentLine] + " ";
        ctx.font = normalFont;
        const textWidth = ctx.measureText(testLine).width;
        const maxWidth = canvas.width * 0.9;
        if(textWidth < maxWidth) userLines[currentLine] += " ";
    }

    // Î∞±Ïä§ÌéòÏù¥Ïä§
    else if(key === "Backspace") {
        if(userLines[currentLine].length > 0) {
            userLines[currentLine] = userLines[currentLine].slice(0, -1);
        } else if(currentLine > 0){
            currentLine--;
        }
    }

    // ÏóîÌÑ∞
    else if(key === "Enter") {
        const maxLines = Math.floor((canvas.height/2 - inputStartY)/lineHeight);
        if(userLines.length < maxLines){
            userLines.splice(currentLine + 1, 0, "");
            currentLine++;
        }
    }
});

// ÏûÖÎ†•Îêú Í∏ÄÏî® Í∑∏Î¶¨Í∏∞
function drawUserText(){
    ctx.textAlign = "left";
    ctx.textBaseline = "top";
    const colorText = moon ? "#ecf0f1" : "#201b13";
    ctx.fillStyle = colorText;
    ctx.font = normalFont;

    for(let i=0; i<userLines.length; i++){
        const y = inputStartY + i*lineHeight;
        ctx.fillText(userLines[i], canvas.width*0.05, y);
    }
}

// Ïï†ÎãàÎ©îÏù¥ÏÖò
function animate(){
    // Î∞∞Í≤Ω
    ctx.fillStyle = bgColor;
    ctx.fillRect(0,0,canvas.width,canvas.height);

    // üåû Ìï¥ / üåô Îã¨ (Îí§ Î†àÏù¥Ïñ¥)
    if(sun){
        if(isAnimatingSun){
            const dx = sun.targetX - sun.x;
            const dy = sun.targetY - sun.y;
            if(Math.abs(dx) < 1 && Math.abs(dy) < 1){
                sun.x = sun.targetX;
                sun.y = sun.targetY;
                isAnimatingSun = false;
            } else {
                sun.x += dx * 0.05;
                sun.y += dy * 0.05;
            }
        }
        ctx.fillStyle = sun.color;
        ctx.beginPath();
        ctx.arc(sun.x, sun.y, sun.radius, 0, Math.PI*2);
        ctx.fill();
    }

    if(moon){
        if(isAnimatingMoon){
            const dx = moon.targetX - moon.x;
            const dy = moon.targetY - moon.y;
            if(Math.abs(dx) < 1 && Math.abs(dy) < 1){
                moon.x = moon.targetX;
                moon.y = moon.targetY;
                isAnimatingMoon = false;
            } else {
                moon.x += dx * 0.05;
                moon.y += dy * 0.05;
            }
        }
        ctx.fillStyle = moon.color;
        ctx.beginPath();
        ctx.arc(moon.x, moon.y, moon.radius, 0, Math.PI*2);
        ctx.fill();
        ctx.fillStyle = bgColor;
        ctx.beginPath();
        ctx.arc(moon.x + 15, moon.y, moon.radius-10, 0, Math.PI*2);
        ctx.fill();
    }

    drawLightnings();

    // üåÑ ÏÇ∞ (ÏÑúÏÑúÌûà Î∞ùÍ∏∞ Î≥ÄÌôî)
    mountains.forEach(m => {
        if(m.currentHeight < m.height) m.currentHeight += 6;
        const targetAdjust = sun ? 10 : (moon ? -20 : 0);
        m.currentAdjust += (targetAdjust - m.currentAdjust) * 0.05;

        ctx.fillStyle = adjustColorBrightness(m.color, m.currentAdjust);
        ctx.beginPath();
        ctx.moveTo(m.x, canvas.height);
        ctx.lineTo(m.x + m.baseWidth/2, canvas.height - m.currentHeight);
        ctx.lineTo(m.x + m.baseWidth, canvas.height);
        ctx.closePath();
        ctx.fill();
    });

    drawEs();
    drawSmiles();

    // üåä Î¨ºÍ≤∞ (ÏÑúÏÑúÌûà Î∞ùÍ∏∞ Î≥ÄÌôî)
    waves.forEach(w => {
        const targetAdjust = sun ? 10 : (moon ? -20 : 0);
        w.currentAdjust += (targetAdjust - w.currentAdjust) * 0.05;

        ctx.strokeStyle = adjustColorBrightness(w.color, w.currentAdjust);
        ctx.lineWidth = w.lineWidth;
        ctx.beginPath();
        for(let x=0; x<=canvas.width; x++){
            const y = w.y + w.amplitude * Math.sin((x + w.offsetX) * 2 * Math.PI / w.wavelength);
            if(x===0) ctx.moveTo(x, y);
            else ctx.lineTo(x, y);
        }
        ctx.stroke();
        w.offsetX += w.speed;
    });

    // üéà ÌíçÏÑ†
    drawBalloons();

    // ÌïòÌä∏
    drawHearts();

    // ‚ú® Í∏ÄÏî® ÏµúÏÉÅÏúÑ
    drawMessage();


    // üìù ÏÇ¨Ïö©Ïûê ÏûÖÎ†•
    drawUserText();

    // üåü Î≤ÑÌäº ÏÉâÏÉÅÎèÑ Ïã§ÏãúÍ∞Ñ ÏóÖÎç∞Ïù¥Ìä∏
    updateResetBtn();

    requestAnimationFrame(animate);
}

animate();

// Î¶¨ÏÇ¨Ïù¥Ï¶à
window.addEventListener("resize", () => {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
});
</script>
</body>
</html>
